<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="generator" content="Jekyll">

  <title>Mining Sefaria</title>

  <link rel="stylesheet" href="/css/main.css">
  
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Mining Sefaria | θεόφιλος Journey</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Mining Sefaria" />
<meta name="author" content="Jorge Murillo" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Coming back to Sefaria." />
<meta property="og:description" content="Coming back to Sefaria." />
<link rel="canonical" href="http://0.0.0.0:7000/B-Sefaria" />
<meta property="og:url" content="http://0.0.0.0:7000/B-Sefaria" />
<meta property="og:site_name" content="θεόφιλος Journey" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-03T00:00:00+00:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:7000/B-Sefaria"},"author":{"@type":"Person","name":"Jorge Murillo"},"@type":"BlogPosting","url":"http://0.0.0.0:7000/B-Sefaria","headline":"Mining Sefaria","dateModified":"2020-11-03T00:00:00+00:00","datePublished":"2020-11-03T00:00:00+00:00","description":"Coming back to Sefaria.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/">
    
    <h1>jorge@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/archive"><h2 class="header-link">Archive</h2></a>
<a href="/about"><h2 class="header-link">About</h2></a>
<a href="https://github.com/murillocjr/theophilusnlp"><h2 class="header-link">Source Code</h2></a>

    </div>
  </div>
</header>
    <div class="container">
      <section id="main_content">
        <article>
  <h2>Mining Sefaria</h2>
  <time datetime="2020-11-03T00:00:00+00:00" class="by-line">03 Nov 2020</time>
  <p>Coming back to <a href="https://www.sefaria.org/">Sefaria</a>.</p>

<blockquote>
  <p>A Living Library of Jewish Texts</p>
</blockquote>

<blockquote>
  <p>Explore 3,000 years of Jewish texts in Hebrew and English translation. Learn More ›</p>
</blockquote>

<p>As mentioned in a previous post ( <a href="A-hebrew">Hebrew</a> ), Sefaria offers a dump of its Mongo Documents database with 2GB of english&amp;hebrew documents in the texts collection only.
The size alone represent a problem for the limited resources of a free EC2 Amazon instance (30GB of disk and 1GB of memory), Google free instance offers even less (512 MB of memory) then there’s Alibaba Cloud which offers 12 months free for a slightly better instance (40GB of disk and 1GB of RAM).</p>

<p>A previous attempt to load (mongorestore) the database failed promptly due to lack of memory (apparently mongo loads all the dump in memory before writing it to disk) so the process died for bson files over 1GB. Even after adding a 4GB swapfile to expand memory availability the process still got stuck halfway just to fail after a long wait. That partial process was luckily enough to extract the Hebrew text of the bible to process it but failed to load all the documents contained in the 2GB dump file.</p>

<p>Second round: AlibabaCloud instance (which doesn’t allow for a free public IP, so no ssh. But solved using zerotier :)….yes, also free ) with 8GB SwapFile was finally able to successfully restore the text collection entirely; Joy!!</p>

<p>BTW, adding a swapfile to my desktop Amazon Mate VNC instance worked wonders too, it stopped hanging on me and allowed me to run more programs without problems.</p>

<p>So here’s a count of the documents:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; show dbs
admin    0.000GB
config   0.000GB
local    0.000GB
sefaria  0.974GB
&gt; use sefaria
switched to db sefaria
&gt; db.texts.count()
7565
&gt; db.texts.find({ language: "en"  }).count()
2366
&gt; db.texts.find({ language: "he"  }).count()
5199
&gt; 
</code></pre></div></div>

<p>So, I have available 2366 Theology-related documents as corpora to build topic-models in English, and 5199 in Hebrew.</p>

<p>Let’s check the structure of the data:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.texts.find({ language: "en"  }).limit(1)
</code></pre></div></div>

<p>returns one document in english</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "_id": ObjectId("4e42dfa71c81c4cf8a4148c2"),
  "status": "locked",
  "versionTitleInHebrew": "משנה פתוחה",
  "license": "CC-BY-SA",
  "chapter": [
    [
      "During the three days preceding the festivals of the non-Jews, it is forbidden to do business with them, to lend them something or to borrow something from them, to lend [money] to them or to borrow [money] from them, to resolve your debt to them or to have them resolve their debt to you. Rabbi Yehuda says: One can have them resolve their debt since it causes him distress. They [the Sages] said to him: even though he might be in distress at the outset, eventually he will be joyful.",
      "Rabbi Yishmael says: [the above] is forbidden for three days before the festivals and three days after the festivals. The Sages say: before the festivals it is forbidden, after the festivals it is permitted.",
      "And these, according to Rabbi Meir, are the festivals of the non-Jews: Kalendae, Saturnalia, Kratesim, kings' days of accession, the day of birth, and the day of death. And the Sages say: every funeral in which a conflagration is present [thereby] involves idol worship. One that has no conflagration does not involve idol worship. [A celebration of] the day on which a [non-Jewish] man cuts his beard or his hair, the day that he came ashore from the sea, and the day he was released from prison, and a pagan who made a feast for his son, [for all these] the prohibition extends only to that day and that man alone.",
      "It is permitted [to do business, etc.] outside of a city that has idolatry within it. If there is idolatry outside the city, it is permitted [to do business, etc.] within the city. Is one permitted to travel to such a place [on the days of their festivals]? If the road leads to this place alone, it is forbidden; but if one can walk along this road to another location, it is permitted. Regarding a city which has idolatry within it, and has both ornamented and un-ornamented shop fronts, this was the case in Beit Sh'an, and [there] the Sages said: The ornamented shops are forbidden and those shops without ornamentation are permitted.",
      "It is forbidden to sell the following items to non-Jews: pine-cones, white figs and their stalks, frankincense, and white chickens. Rabbi Yehuda says: one is permitted to sell them a white chicken amongst a group of chickens; and if it is alone he must clip its toe and sell it, since they do not sacrifice blemished animals for idolatry. As for all remaining items, if [their intention was] not specified one is permitted [to sell them], but if specified, it is forbidden. Rabbi Meir says: fine palm dates, sweet dates, and the Nikolaos dates are also forbidden to be sold to non-Jews.",
      "In a place in which it is customary to sell small livestock to non-Jews, one may sell. In a place in which it is customary not to sell, one may not sell. And in all places it is forbidden to sell them large livestock, calves or foals, healthy or broken. Rabbi Yehuda permits in the case of a broken one. Ben Beterah permits in the case of a horse.",
      "One may not sell to them bears, lions, or anything that may cause harm to the public. One cannot build with them a basilica, a gallows, a stadium, or a dais. But one can build with them public bathhouses, as well as [private] bathhouses. [In the building process,] when they reach the arched chamber in which they erect an object of idolatry, it is forbidden to [help] build.",
      "One may not make jewelry for purposes of idolatry: necklaces, nose rings, or rings. Rabbi Eliezer says: It is permissible to do so for a salary. One may not sell them produce that is connected to the ground. But it may be sold once it is picked. Rabbi Yehuda says: One may sell [unpicked produce] with an agreement that it will be picked. One may not rent them houses in the Land of Israel, and we need not even mention fields [which are certainly forbidden to rent]; and in Syria [conquered land North of Israel, treated like Israel only with regard to some laws], one may rent them houses, but not fields; and outside of the Land one may sell them houses and rent them fields; these are words of Rabbi Meir. Rabbi Yosei says: In the Land of Israel it is permitted to rent them houses but not fields; and in Syria it is permitted to sell them houses and rent them fields; and outside of the Land, one may sell them either one.",
      "Even in the cases in which they permitted renting out [to a non-Jew], they did not say this regarding permanent residence, for he will bring an idol into it, as it is said (Devarim 7:26): You shall not bring an abomination into your house. And one is always forbidden to rent him a [private] bathhouse, because it will still be called by his [the Jew's] name."
    ],
    [
      "One should not leave cattle in the inns of non-Jews, for they are suspect regarding bestiality. A woman should not be alone with them for they are suspect regarding fornication. A man should not be alone with them, for they are suspect regarding the spilling of blood. A Jewess should not be a midwife to a non-Jewish woman, for she is birthing one for [a life of] idolatry. But a non-Jewish woman may be a midwife to a Jewess. A Jewess may not suckle a child of a non-Jewish woman, but a non-Jewish woman may suckle the child of a Jewess, within her domain.",
      "One may accept their [non-Jew's] healing for one's property, but not healing for people. And one should not have one's hair cut by them under any circumstances, according to Rabbi Meir. And the Sages say: It is permitted [to have a non-Jew cut a Jew's hair] in public domains, but not amongst the two of them [alone].",
      "These are the items of non-Jews which are prohibited, and their prohibition is on deriving any benefit from them at all: wine, the vinegar of non-Jews which began as wine, Hadrianic earthenware, and hides that were pierced at the heart. Rabbi Shimon ben Gamliel says: If [the hole is] round then it is prohibited, but if it is stretched it is allowed. Meat that is entering [a place of] idolatry is allowed, but leaving, it is prohibited, because it is like sacrifices of the dead, according to Rabbi Akiva. Those who are going on an idolatrous pilgrimage, it is prohibited to do business with them, but with those who are coming back, it is permitted.",
      "The water-skins of non-Jews and their containers which contain a Jew's wine within them, they are prohibited and it is prohibited to derive any benefit from them, according to Rabbi Meir. The Sages say: Their prohibition is not against deriving benefit from them. The grape pits and grape skins of non-Jews are prohibited and it is prohibited to derive any benefit from them, according to Rabbi Meir. The Sages say: If they are moist, they are prohibited, if dry, they are permitted. The fish-brine and Bithynian cheese of non-Jews are prohibited and it is prohibited to derive any benefit from them, according to Rabbi Meir. The Sages say: Their prohibition is not against deriving benefit from them.",
      "Rabbi Yehuda says: Rabbi Ishmael asked Rabbi Yehoshua [a question] as they were walking along the road. He said to him, \"What is the cause for the prohibition against the cheese of non-Jews?\" He said to him, \"Because they curdle it inside the stomach of carrion.\" He said to him, \"But is not [the law regarding] the stomach of a burnt offering more stringent than the stomach of carrion?! And they [the Sages] said: [It was proposed that] a priest with a good disposition may burn [a burnt offering after sucking out the fat from its stomach] while it it still raw [and has not yet been burnt with the offering, which would forbid one form deriving any benefit from it]. And they [the sages] did not agree with him [who proposed this opinion], but they said: One may not derive benefit [from the fats of the stomach], nor is one [who does so] liable for &lt;i&gt;meilah&lt;/i&gt; [deriving prohibited benefit from from a sanctified object].\" [Implying that one should therefore not be liable for the less stringent case of a stomach of carrion.] He [Rabbi Yehoshua] retracted, and [instead] said, \"Because they curdle it in the stomachs of calves that were used for idolatry.\" And he [Rabbi Ishmael] said, \"If so, why is there no prohibition to benefit from it?\" He [Rabbi Yehoshua] redirected him to another topic. He said to him, \"Ishmael, my brother, how do you read (Shir HaShirim 1): 'For &lt;i&gt;dodechah&lt;/i&gt; [Heb. masc: \"your love\"] is better than wine,' or 'For &lt;i&gt;dodayich&lt;/i&gt; [Heb. fem: \"your love\") is better than wine'? He said to him:, \"'For &lt;i&gt;dodayich&lt;/i&gt; is better than wine.'\" He said to him, \"The matter is not so. For its fellow [the following verse] teaches about it: 'For the fragrance of &lt;i&gt;shemaneikha&lt;/i&gt; [Heb. masc: \"your oils\"] is good.'\"",
      "These are the items of non-Jews that are prohibited, yet their prohibition is not against deriving benefit from them: milk that was milked by a non-Jew without a Jew watching, and [their] bread, and their oil [although] Rabbi and his court permitted [their] oil, and stewed vegetables, and pickled vegetables to which it is their custom to add wine and vinegar, and minced fish, and fish-brine that does not have kilbit [a kind of small fish] floating in it, and the chilaq fish, and a [cut] piece of asafoetida, and seasoned salt, all of these [items of non-Jews] are prohibited yet their prohibition is not against deriving any benefit from them.",
      "The following are permitted to be eaten: milk that was milked by a non-Jew with a Jew watching, and honey, and bunches of grapes [alt. honeycombs], even though they drip they are not considered primed [for impurity] by a liquid, and pickled vegetables to which it is not their custom to add wine and vinegar, and fish that is not minced, and brine that has fish in it, and [whole] asafoetida leaves, and rolls of [heated] olives. Rabbi Yose says: the [olives that became] very soft are forbidden. Locusts that come from the [shopkeeper's] basket are prohibited, from but those from the stock-room are allowed, and so too regarding the priestly tithe."
    ],
    [
      "All images are prohibited, because each one is worshiped once a year, according to Rabbi Meir. But the Sages say: Only that which has in its hand  a stick, or a bird, or an orb is prohibited. Rabban Shimon ben Gamliel says: Any that has anything in its hand [is prohibited].",
      "If one finds shards of an image, these are permitted. If one finds the form of a hand or the form of a foot, these are prohibited, because equivalent ones are worshiped.",
      "If one finds vessels with a drawing upon it of the sun, or a drawing of the moon, or a drawing of a dragon, he should bring them to the Salt Sea [to dispose of them there]. Rabban Shimon ben Gamliel says: Those upon those [vessels] which are treated with honor are forbidden; those upon those [vessels] treated disrespectfully are permitted. Rabbi Yose says: One should grind [the vessel with the drawing] and disperse it to the wind or cast it into the sea. They [the Sages] said to him: Even that might become fertilizer, as it is said (Devarim/Deuteronomy 13:18): \"And let nothing of the condemned cling to your hand.\"",
      "Proklos son of Plosfos asked Rabban Gamliel [a question] in Akko, while he was bathing in the bathhouse of Aphrodite.  He said to him: \"It is written in your Torah (Deuteronomy 13:18): 'And let none of the condemned cling to your hand;' why then are you bathing in the bathhouse of Aphrodite?  He said to him: one does not respond [to halakhic questions] in the bathhouse. When he left, he said to him:  \"I did not come into her territory; she came into my territory.  They did not say [when they built this bathhouse]: 'Let us make a beautiful bathhouse for Aphrodite.'  Rather, they said: 'Let us make Aphrodite for the beauty of the bathhouse.' Another reason: [even] if they gave you a lot of money, you would not enter before your idolatry naked and defiled and urinating in front of it.  Yet she stands on the sewer pipe and the entire nation urinates in front of her. The verse (Deuteronomy 12:3) only applies to \"their gods;\" that which he treats like a god is prohibited, and that which he does not treat like a god is permitted.\"",
      "Non-Jews who worship the mountains and hills, they [the mountains and hills themselves] are permitted, but that which is upon them is forbidden, as it says (Deuteronomy 7:25): You shall not covet the gold and silver that is upon them and take it. Rabbi Yose the Galilean said (Deuteronomy 12:2): \"Their gods upon the mountains,\" but the mountains are not their gods; their gods \"upon the hills,\" but the hills are not their gods. And why are Asherah trees forbidden? Because humans hands were involved in [planting] them, and any [idolatrous] thing that human hands were involved in is forbidden. Rabbi Akiva said: I will expound [the verse] and rule before you, everywhere that you find a tall mountain, a raised hill, or a verdant tree know that there is idol worship there.",
      "One whose house abuts [a house of] idolatry, and [his own house] collapses, it is prohibited to rebuild it. How should he proceed? He should gather it four cubits into his own [space] and build. If it [the wall that collapsed] belonged both to him and to the [house of] idolatry, the [respective] law applies to each half [and only his own half may be rebuilt]. The stones, wood, and dust [of a house of idolatry] have a ritual impurity like that of vermin [i.e. through contact], as it says (Deuteronomy 7:26): You shall utterly detest it. Rabbi Akiva says: like that of a menstruating woman, as it says (Isaiah 30:22): \"You will banish them like a menstruating woman. ‘Get out!’ you will say to it.” Just as a menstruating woman renders objects impure through carrying, so too does idol worship render objects impure through carrying.",
      "There are three [types of] houses. A house that is initially built for idolatry: this is prohibited. If it was painted and the molding was put in for idolatry, or if it was renewed [for idolatry], what is new is removed [and the rest is permitted]. If idols are brought inside and removed: this [house] is permitted. There are three [types of] stones. A stone initially hewed to be a pedestal [for an idol]: this is prohibited. If it was painted or molded for idolatry, or renewed [for idolatry], what is new is removed. If an idol was erected on top of it and removed: this [stone] is permitted. There are three [types of] &lt;i&gt;asherot&lt;/i&gt;. A tree initially planted for idolatry: this is prohibited. If it was pruned and trimmed for idolatry and it sprouted, the new growth is removed. If an idol is erected under it and taken away: this [tree] is permitted. What is an &lt;i&gt;asherah&lt;/i&gt;? Every [tree] that has idolatry below it. Rabbi Shimon says: Every [tree] that is worshiped. It happened in Tzidon, regarding a tree that was worshiped, that they found below it a pile of stones. Rabbi Shimon said to them: \"Examine this pile.\" They examined it and found an image. He said to them: \"Because the image is what was worshiped, we shall permit the tree for them.\"",
      "One should not sit in its shade, but if one did sit he is pure. One should not pass beneath it, and if one did pass he is impure. If it encroaches on the public [domain], one who passes beneath it is pure. Vegetables may be sown beneath it in the rainy season but not in the sunny season. Lettuces may [be sown there] neither in the sunny season nor in the rainy season. Rabbi Yose says: Not even vegetables in the rainy season, because the leaves [of the &lt;i&gt;ashera&lt;/i&gt;] fall on them and become fertilizer.",
      "If one took some wood from it, it is prohibited for benefit.  If one stoked the oven with it: if [the oven] is new, it must be shattered; if old, it must be cooled.  If one baked bread in it, it is prohibited for benefit. If [the bread] became mixed up with others, they are all prohibited for benefit.  Rabbi Eliezer said: Let him cast [a sum equivalent to the worth of their] benefit into the Dead Sea!  They said to him: There is no redemption when it comes to idolatry.  If one took wood from it for a loom, it is prohibited for benefit. If he wove a garment with it, the garment is prohibited for benefit. If that garment became mixed up with others, and then those others became mixed up with others, they are all prohibited for benefit. Rabbi Eliezer said: Let him cast [a sum equivalent to the worth of their] benefit into the Dead Sea!  They said to him: There is no redemption when it comes to idolatry.",
      "How does one annul [the idolatrous status of an &lt;i&gt;asherah&lt;/i&gt;]? If one trims or prunes, removes a branch or a stick, or even a leaf, it is annulled.  If [after picking from it] one smooths it over for its tree's [aesthetic] sake, it is prohibited, but if not for its sake, then it is permitted."
    ]
  ],
  "title": "Mishnah Avodah Zarah",
  "language": "en",
  "versionTitle": "Open Mishnah",
  "licenseVetted": true,
  "versionSource": "http://en.wikisource.org/wiki/Mishnah"
}
</code></pre></div></div>

<p>Good news: it’s divided in chapters</p>

<p>we have title in Hebrew and also <code class="language-plaintext highlighter-rouge">versionTitle</code> as an English alternative, lets list all the available titles.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mongo 127.0.0.1/sefaria --eval "DBQuery.shellBatchSize = 6000; db.texts.find({ language: 'en'}, { title: 1, versionTitle: 1})" &gt;&gt; english_titles.txt
</code></pre></div></div>

<p>creates a file with all the titles in english in the following format::</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ "_id" : ObjectId("50eb90e828e38dee15e1d186"), "title" : "Ramban on Exodus", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("5123f3dff8af4f5062356ed6"), "title" : "Esther Rabbah", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("513f8f5ef8af4f5062356f0c"), "title" : "Pesachim", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("5141fde8f8af4f5062356f14"), "title" : "Genesis", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("514234ddf8af4f5062356f16"), "title" : "Legends of the Jews", "versionTitle" : "The Legends of the Jews by Louis Ginzberg [1909]" }
{ "_id" : ObjectId("515e727df8af4f5062356f3b"), "title" : "Vayikra Rabbah", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("5164a68cf8af4f5062356f53"), "versionTitle" : "Eighteen Treatises from the Mishna", "title" : "Mishnah Shabbat" }
{ "_id" : ObjectId("5166160df8af4f5062356f56"), "versionTitle" : "Eighteen Treatises from the Mishna", "title" : "Mishnah Eruvin" }
{ "_id" : ObjectId("516aa2ed0fd3600d337b84d8"), "title" : "Taanit", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("516aa8620fd3600d337b84da"), "title" : "Eichah Rabbah", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("516aadf50fd3600d337b84db"), "title" : "Bava Kamma", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("516c17030fd3600d337b84e6"), "title" : "Rashi on Leviticus", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("516f1fb1edbab438be881fac"), "versionTitle" : "Wikisource Mishneh Torah", "title" : "Mishneh Torah, Foundations of the Torah" }
{ "_id" : ObjectId("516f1fb1edbab438be881fb3"), "title" : "Mishneh Torah, Foundations of the Torah", "versionTitle" : "Sefaria Community Translation" }
{ "_id" : ObjectId("516f1fb1edbab438be881fb4"), "versionTitle" : "Sefaria Community Translation", "title" : "Mishneh Torah, Torah Study" }

</code></pre></div></div>

<p><a href="C-English-Titles">Here</a> the complete list.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Previous</th>
      <th style="text-align: left">Home</th>
      <th style="text-align: left">Next</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><a href="A-Processing-PDF">Processing PDF</a></td>
      <td style="text-align: left"><a href="A-θεόφιλος-Journey">θεόφιλος Journey</a></td>
      <td style="text-align: left"><a href="C-English-Titles">English Titles</a></td>
    </tr>
  </tbody>
</table>

</article>
      </section>
    </div>
  </div>

   <footer>
    <a href="http://murillocjr.github.io/">
    <span>
        <b>Jorge Murillo</b>
    </span>
    
    <span>© 2020</span>
    </a>
</footer>


  
    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-49256786-5', 'auto');
  ga('send', 'pageview');
</script>
  
</body>

</html>